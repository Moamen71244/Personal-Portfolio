let navlinks=Array.from(document.querySelectorAll(".nav-links a")),themeBtn=document.getElementById("theme-toggle-button"),sections=Array.from(document.querySelectorAll("section[id]")),settingsToggle=document.getElementById("settings-toggle"),settingsSidebar=document.getElementById("settings-sidebar"),settingsClose=document.getElementById("close-settings"),resetSettings=document.getElementById("reset-settings"),fontBtns=document.querySelectorAll(".font-option"),theme=localStorage.getItem("theme")||"dark",fontTheme=localStorage.getItem("fontTheme")||"tajawal",scrollToTopBtn=document.getElementById("scroll-to-top"),colorBtns=document.querySelectorAll("[data-primary]"),root=document.documentElement;const filterBtns=document.querySelectorAll(".portfolio-filter"),portfolioItems=document.querySelectorAll(".portfolio-item"),timeToAnimate=400,defaultFont="tajawal",defaultThemePrimary="#6366f1",defaultThemeSecandry="#8b5cf6";function getCurrentSec(){let e="";return sections.forEach((t=>{window.scrollY>=t.offsetTop-120&&(e=t.id)})),activeLink(e),e}function activeLink(e){e&&navlinks.forEach((t=>{t.classList.toggle("active",t.href.slice(t.href.indexOf("#")+1)===e)}))}function showScrollBtn(){window.scrollY>1e3?(scrollToTopBtn.classList.replace("invisible","visible"),scrollToTopBtn.classList.remove("opacity-0")):(scrollToTopBtn.classList.add("opacity-0"),scrollToTopBtn.classList.remove("visible","invisible"))}function getTheme(){const e=localStorage.getItem("color-primary"),t=localStorage.getItem("color-secondary");e&&t&&(root.style.setProperty("--color-primary",e),root.style.setProperty("--color-secondary",t))}function styleColorBtn(){colorBtns.forEach((e=>{e.getAttribute("data-primary")===root.style.getPropertyValue("--color-primary")&&e.classList.add("ring-2","ring-primary","ring-offset-2","ring-offset-white","dark:ring-offset-slate-900")}))}function initTestimonialsSlider(){const e=document.getElementById("testimonials-carousel"),t=document.getElementById("prev-testimonial"),r=document.getElementById("next-testimonial"),o=document.querySelectorAll(".carousel-indicator"),s=document.querySelectorAll(".testimonial-card");if(!(e&&t&&r&&s.length))return;let a=0;const l=s.length;function n(){return window.innerWidth<640?1:window.innerWidth<1024?2:3}function i(){const t=n(),r=l-t;a=Math.max(0,Math.min(a,r));const s=100/t*a;e.style.transform=`translateX(${s}%)`,o.forEach(((e,t)=>{e.classList.toggle("active",t===a),e.classList.toggle("bg-accent",t===a),e.classList.toggle("scale-125",t===a),e.classList.toggle("bg-slate-400",t!==a),e.classList.toggle("dark:bg-slate-600",t!==a)}))}let c;r.addEventListener("click",(function(){const e=n();a=a<l-e?a+1:0,i()})),t.addEventListener("click",(function(){const e=n();a=a>0?a-1:l-e,i()})),o.forEach(((e,t)=>e.addEventListener("click",(()=>{a=t,i()})))),window.addEventListener("resize",(()=>{clearTimeout(c),c=setTimeout(i,150)})),i()}function initContactForm(){const e=document.querySelector("#contact form");if(!e)return;const t=e.querySelectorAll("input, textarea"),r=["name","email","phone","message"];function o(e,t){const r=document.createElement("p");r.className="error-message text-red-400 text-sm mt-1",r.textContent=t,e.classList.contains("custom-select-wrapper")?e.appendChild(r):(e.classList.add("border-red-500"),e.parentElement.appendChild(r))}t.forEach(((e,t)=>{if(!r[t])return;e.id=`contact-${r[t]}`;const o=e.previousElementSibling;o&&"LABEL"===o.tagName&&o.setAttribute("for",e.id)})),e.addEventListener("submit",(function(t){t.preventDefault();let r=!0;e.querySelectorAll(".error-message").forEach((e=>e.remove())),e.querySelectorAll(".border-red-500").forEach((e=>e.classList.remove("border-red-500")));const s=e.querySelector('input[type="text"]'),a=e.querySelector('input[type="email"]'),l=e.querySelector('input[type="tel"]'),n=e.querySelector("textarea"),i=e.querySelector('.custom-select[data-name="project-type"] .selected-text');s.value.trim()||(o(s,"يرجى إدخال الاسم الكامل"),r=!1);if(a.value.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value)||(o(a,"يرجى إدخال بريد إلكتروني صحيح"),r=!1):(o(a,"يرجى إدخال البريد الإلكتروني"),r=!1),l.value.trim()&&!/^(\+?2)?(\+?20)?01[1250]{1}\d{8}$/.test(l.value.replace(/\s/g,""))&&(o(l,"يرجى إدخال رقم هاتف صحيح"),r=!1),i.classList.contains("text-slate-400")){const e=i.closest(".custom-select-wrapper");e.querySelector(".custom-select").classList.add("border-red-500"),o(e,"يرجى اختيار نوع المشروع"),r=!1}n.value.trim()?n.value.trim().length<10&&(o(n,"يرجى إدخال المزيد من التفاصيل"),r=!1):(o(n,"يرجى إدخال تفاصيل المشروع"),r=!1),r&&(!function(){const e=document.createElement("div");e.className="fixed inset-0 flex items-center justify-center z-50 bg-slate-950/80 backdrop-blur-sm",e.innerHTML='\n      <div class="bg-slate-800 rounded-2xl p-8 max-w-md text-center border border-slate-700 shadow-2xl">\n        <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6">\n          <i class="fa-solid fa-check text-4xl text-white"></i>\n        </div>\n        <h3 class="text-2xl font-bold mb-3">تم إرسال رسالتك بنجاح!</h3>\n        <p class="text-slate-400 mb-6">شكراً لتواصلك، سيتم الرد عليك قريباً.</p>\n        <button class="success-popup-close bg-primary px-6 py-3 rounded-xl">حسناً</button>\n      </div>\n    ',document.body.appendChild(e),e.querySelector(".success-popup-close").addEventListener("click",(()=>e.remove())),setTimeout((()=>e.remove()),4e3)}(),e.reset(),e.querySelectorAll(".selected-text").forEach((e=>{e.classList.add("text-slate-500","dark:text-slate-400"),e.classList.remove("text-slate-800","dark:text-white")})),e.querySelector('.custom-select[data-name="project-type"] .selected-text').textContent="اختر نوع المشروع",e.querySelector('.custom-select[data-name="budget"] .selected-text').textContent="اختر الميزانية")})),t.forEach((e=>{e.addEventListener("input",(function(){this.classList.remove("border-red-500");const e=this.parentElement.querySelector(".error-message");e&&e.remove()}))}))}initContactForm(),initTestimonialsSlider(),fontBtns.forEach((e=>{e.addEventListener("click",(function(){e.classList.add("active","border-primary","dark:bg-slate-800"),e.classList.remove("border-slate-200","dark:border-slate-700"),fontBtns.forEach((t=>{e!==t&&t.classList.contains("active")&&(t.classList.remove("active","border-primary","dark:bg-slate-800"),t.classList.add("border-slate-200","dark:border-slate-700"))}));const t=e.getAttribute("data-font");document.body.style.fontFamily=t,localStorage.setItem("fontTheme",t)}))})),settingsToggle.addEventListener("click",(function(){settingsToggle&&settingsSidebar&&settingsClose&&(settingsSidebar.classList.remove("translate-x-full"),settingsToggle.style.right="20rem")})),settingsClose.addEventListener("click",(function(){settingsToggle&&settingsSidebar&&settingsClose&&(settingsSidebar.classList.add("translate-x-full"),settingsToggle.style.right="0")})),window.addEventListener("load",(()=>{getCurrentSec(),document.documentElement.classList.add(theme),document.body.style.fontFamily=fontTheme,fontBtns.forEach((e=>{e.getAttribute("data-font")===fontTheme?(e.classList.add("active","border-primary","dark:bg-slate-800"),e.classList.remove("border-slate-200","dark:border-slate-700")):(e.classList.remove("active","border-primary","dark:bg-slate-800"),e.classList.add("border-slate-200","dark:border-slate-700"))})),getTheme(),styleColorBtn()})),scrollToTopBtn&&scrollToTopBtn.addEventListener("click",(()=>window.scrollTo(0,0))),window.addEventListener("scroll",(()=>{getCurrentSec(),showScrollBtn()})),themeBtn.addEventListener("click",(()=>{document.documentElement.classList.toggle("dark"),theme=document.documentElement.classList.contains("dark")?"dark":"light",localStorage.setItem("theme",theme)})),resetSettings.addEventListener("click",(()=>{root.style.setProperty("--color-primary","#6366f1"),root.style.setProperty("--color-secondary","#8b5cf6"),document.body.style.fontFamily="tajawal",localStorage.removeItem("color-primary"),localStorage.removeItem("color-secondary"),fontBtns.forEach((e=>{e.classList.remove("active","border-primary","dark:bg-slate-800"),e.classList.add("border-slate-200","dark:border-slate-700"),"tajawal"===e.getAttribute("data-font")&&(e.classList.add("active","border-primary","dark:bg-slate-800"),localStorage.setItem("fontTheme","tajawal"))})),colorBtns.forEach((e=>{e.classList.remove("ring-2","ring-primary","ring-offset-2","ring-offset-white","dark:ring-offset-slate-900"),e.getAttribute("data-primary")===root.style.getPropertyValue("--color-primary")&&e.classList.add("ring-2","ring-primary","ring-offset-2","ring-offset-white","dark:ring-offset-slate-900")}))})),colorBtns.forEach((e=>{e.addEventListener("click",(function(){const t=e.getAttribute("data-primary"),r=e.getAttribute("data-secondary");root.style.setProperty("--color-primary",t),root.style.setProperty("--color-secondary",r),localStorage.setItem("color-primary",t),localStorage.setItem("color-secondary",r),colorBtns.forEach((e=>e.classList.remove("ring-2","ring-primary"))),e.classList.add("ring-2","ring-primary","ring-offset-2","ring-offset-white","dark:ring-offset-slate-900")}))})),portfolioItems.forEach((e=>e.style.transition="opacity 0.3s ease, transform 0.3s ease")),filterBtns.forEach((e=>{e.addEventListener("click",(function(){const t=e.dataset.filter;portfolioItems.forEach((e=>{e.style.opacity="0",e.style.transform="scale(0.95)"})),filterBtns.forEach((e=>{e.classList.remove("active","bg-linear-to-r","from-primary","to-secondary","text-white","shadow-lg","shadow-primary/50"),e.setAttribute("aria-pressed","false")})),e.classList.add("active","bg-linear-to-r","from-primary","to-secondary","text-white","shadow-lg","shadow-primary/50"),e.setAttribute("aria-pressed","true"),setTimeout((()=>{portfolioItems.forEach((e=>{const r=e.dataset.category;e.style.display="all"===t||r===t?"":"none"})),requestAnimationFrame((()=>{portfolioItems.forEach((e=>{"none"!==e.style.display&&(e.style.opacity="1",e.style.transform="scale(1)")}))}))}),400)}))})),initContactForm();